---
title: "Final script for master data"
author: "Katarina Stekic"
date: "1/15/2020"
output: html_document
---

#Introduction

Firstly, the data colected from 10 experimental conditions was modeled for correctness and reaction time. From the results, it was concluded to do further analysis and prepare the experiment for Study 2 on data collected from conditions 1,2,3(3A),9 and 10. 

Next, the data was modeled for BLock significance, and it was decided to leave five blocks for training and two blocks for testing in Study 2 design. 

We further invastigated image sets and image curviness as dependent variables, which led to the reduction of the number of images needed for Study 2. Out of the 40 images used in Study 1, 5 extremely curvy image pairs were choses (0 or 30 percent curviness) for the training set, while additional unpaired 3 curvy and 3 jagged images were chosen for the new labels in the testing set, also in their extreme versions. 

Finally, from the vast amount of labels produced for the purspose of Study 1, we have chosen four labels for Study 2. First, we looked at labels which were used in Study one as category labels, as only these labels are needed for Study 2. Next, we have filtered out all labels with long versions of the /a/ sound. We chose randomly one label from each label category (jagged, curvy, conventional A and B), leaving us with four category labels for Study 2. 

Participants in Study 2 will be instructed to categorize stimuli through 62 trials (50 training + 12 testing) and also urged to pay careful attention to the sound labels. 

####Loading libraries
```{r}
library(data.table)
library(tidyverse)
library(ggthemes)
library(outliers)
library(lme4)
library(lmerTest)
library(afex)
library(kableExtra)
library(agricolae)
library(multcomp)
```

####Modeling Correctness Training data with Block as fixed factor
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$ImageSeed <- as.factor(DataNew$ImageSeed)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "3B"|Condition == "9"|Condition == "10")

DataTraining <- subset(DataSubset, TrialType == "Testing")

Model.Block.Training <- glmer(RT ~ Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          #family= binomial())
                          family= inverse.gaussian(link = "identity"))

summary(Model.Block.Training)

anova(Model.Block.Training)

summary(glht(Model.Block.Training, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling Correctness Testing data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$ImageSeed <- as.factor(DataNew$ImageSeed)


#DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       #Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Block.Testing <- glmer(RespCorr ~ Block +
                          (1|ImageSeed),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Block.Testing)

anova(Model.Block.Testing)

summary(glht(Model.Block.Testing, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling Correctness Training data with Block as fixed factor / 5 chosen conditions for Study 2
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "4"|Condition == "3A"|Condition == "10"|Condition == "6A")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Block.Training <- glmer(RespCorr ~ Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= binomial)

summary(Model.Block.Training)

anova(Model.Block.Training)

summary(glht(Model.Block.Training, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling Correctness Testing data with Block as fixed factor / 5 chosen conditions for Study 2
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "10"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Block.Testing <- glmer(RespCorr ~ Condition * Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Block.Testing)

anova(Model.Block.Testing)

summary(glht(Model.Block.Testing, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Plotting Correctness through Block and Trial type
```{r}

DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

#DataNew$Condition <- as.factor(DataNew$Condition)
#DataNew$Block <- as.factor(DataNew$Block)
#DataNew$Set <- as.factor(DataNew$Set)

DataSubset <- subset(DataNew, Set == "1"|Set == "2"|Set == "3"|Set == "4")


DataSubset$TrialType2 = factor(DataSubset$TrialType2, levels=c("Training","Testing-Old","Testing-New"), labels=c("Training","Testing-Old","Testing-New")) 

ggplot(DataSubset, aes(x= Block, y= RespCorr, colour= Set, linetype = Set)) + 
  geom_smooth(aes(colour = Set),size = 1.0,se = FALSE, method= 'loess', formula =  y~x)+
  
  scale_linetype_manual(values = c("solid","dotdash","longdash","twodash")) +
  
  scale_color_manual(values= c("#0066CC","#33FF00","#CC0033","#FF9900")) +
                               
  ggtitle("Performance by Block") +
  labs(x="Block", y="Proportion of Correctness") +
  facet_grid(~TrialType2, scales="free", space= "free_x" ) +
  theme(axis.title.y = element_text(size=12,  color="#666666")) +
  theme(axis.text = element_text(size=8)) +
  theme(plot.title = element_text(size=16, face="bold", hjust=0, color="#666666")) +
  theme(strip.text.x = element_text(size = 8, colour = "black")) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank())

```

####Modeling RT Training data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Block.Training <- glmer(RT ~ Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= gaussian())

summary(Model.Block.Training)

anova(Model.Block.Training)

summary(glht(Model.Block.Training, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling RT Testing data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Block.Testing <- glmer(RT ~ Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= gaussian())

summary(Model.Block.Testing)

anova(Model.Block.Testing)

summary(glht(Model.Block.Testing, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Plotting RTs through Block and Trial type
```{r}

DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataSubset <- subset(DataNew, Condition == "1"|Condition == "3A"|Condition == "4"|Condition == "6A"| Condition == "10"| Condition == "10")

DataSubset$TrialType2 = factor(DataSubset$TrialType2, levels=c("Training","Testing-Old","Testing-New"), labels=c("Training","Testing-Old","Testing-New")) 

ggplot(DataSubset, aes(x= Block, y= RT, colour= Condition, linetype = Condition)) + 
  geom_smooth(aes(colour = Condition),size = 1.0,se = TRUE, method= 'loess', formula =  y~x)+
  
  scale_linetype_manual(values = c("solid","Solid","longdash","twodash","dotdash","dotdash")) +
  
  scale_color_manual(values= c("#33FF00","#000000","#18490C","#CC0033","#970808","#970808")) +
                               
  ggtitle("RT by Block") +
  labs(x="Block", y="RT") +
  facet_grid(~TrialType2, scales="free", space= "free_x" ) +
  theme(axis.title.y = element_text(size=12,  color="#666666")) +
  theme(axis.text = element_text(size=8)) +
  theme(plot.title = element_text(size=16, face="bold", hjust=0, color="#666666")) +
  theme(strip.text.x = element_text(size = 8, colour = "black"))

```

####Modeling Correctness for Stimuli Sets / Training
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Set.Training <- glmer(RespCorr ~ Set +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= binomial)

summary(Model.Set.Training)

anova(Model.Set.Training)

summary(glht(Model.Set.Training, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling Corectness for Stimuli Sets / Testing
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Set.Testing <- glmer(RespCorr ~ Set +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Set.Testing)

anova(Model.Set.Testing)

summary(glht(Model.Set.Testing, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling RTs for Stimuli Sets / Training
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Set.Training <- glmer(RT ~ Set +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= gaussian)

summary(Model.Set.Training)

anova(Model.Set.Training)

summary(glht(Model.Set.Training, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling RTs for Stimuli Sets / Testing
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Set.Testing <- glmer(RT ~ Set +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= gaussian)

summary(Model.Set.Testing)

anova(Model.Set.Testing)

summary(glht(Model.Set.Testing, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

