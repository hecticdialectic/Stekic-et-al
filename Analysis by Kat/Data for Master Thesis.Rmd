---
title: "Pilot Data for Master Thesis"
output: 
  html_document:
    keep_md: true
    theme: journal
    toc: true
    toc_depth: 2
    toc_float: 
      collapsed: false
    code_folding: hide
---
#Pilot data exploration

####Loading Libraries
```{r}
library(data.table)
library(tidyverse)
library(ggthemes)
library(outliers)
library(lme4)
library(lmerTest)
library(afex)
library(kableExtra)
library(agricolae)
library(multcomp)
```

####Plotting Correctness through Trial type (it works with CleanData4!!!)
```{r}

DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$ImageSeed <- as.factor(DataNew$ImageSeed)

DataSubset <- subset(DataNew, Condition == "1"|Condition == "3A"|Condition == "4"|Condition == "10"|Condition == "6A")

DataSubset$TrialType2 = factor(DataSubset$TrialType2, levels=c("Training","Testing-Old","Testing-New"), labels=c("Trening","Test-Stari","Test-Novi")) 

ggplot(DataSubset, aes(x= Block, y= RespCorr, colour = Condition, linetype = Condition) + 
  geom_smooth(aes(colour = Condition),size = 1.0,se = FALSE, method= 'loess', formula =  y~x)+
  
  scale_linetype_manual(values = c("solid","Solid","longdash","twodash","dotdash")) +
  
  scale_color_manual(values= c("#33FF00","#000000","#18490C","#CC0033","#970808")) +
                               
  ggtitle("Tacnost kategorizacije") +
  labs(x="Blok", y="Proporcija tacnosti") +
  facet_grid(~TrialType2, scales="free", space= "free_x" ) +
  theme(axis.title.y = element_text(size=12,  color="#666666")) +
  theme(axis.text = element_text(size=8)) +
  theme(plot.title = element_text(size=16, face="bold", hjust=0, color="#666666")) +
  theme(strip.text.x = element_text(size = 8, colour = "black")) +
  theme_bw())
  #theme(panel.grid.major = element_blank, panel.grid.minor = element_blank(),panel.background = element_blank())

```

####Plotting Rts through Trial type (it works with CleanData4!!!)
```{r}

DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataSubset <- subset(DataNew, Condition == "1"|Condition == "3A"|Condition == "6A"|Condition == "4"|Condition == "10")

DataSubset$TrialType2 = factor(DataSubset$TrialType2, levels=c("Training","Testing-Old","Testing-New"), labels=c("Trening","Test-Stari","Test-Novi")) 

ggplot(DataSubset, aes(x= Block, y= RespCorr, colour= Condition, linetype = Condition)) + 
  geom_smooth(aes(colour = Condition),size = 1.0,se = FALSE, method= 'loess', formula =  y~x)+
  
  scale_linetype_manual(values = c("solid","Solid", "longdash", "twodash", "dotdash")) +
  
  scale_color_manual(values= c("#33FF00", "#000000","#18490C","#CC0033","#970808")) +
                               
  ggtitle("Vreme kategorizacije") +
  labs(x="Blok", y="Vreme u ms") +
  facet_grid(~TrialType2, scales="free", space= "free_x" ) +
  theme(axis.title.y = element_text(size=12,  color="#666666")) +
  theme(axis.text = element_text(size=8)) +
  theme(plot.title = element_text(size=16, face="bold", hjust=0, color="#666666")) +
  theme(strip.text.x = element_text(size = 8, colour = "black")) +
  theme_bw()
  #theme(panel.grid.major = element_blank, panel.grid.minor = element_blank(),panel.background = element_blank())


```

####Modeling master thesis Correctness pilot data for Test Condition + Block
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)

DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "10"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Ress.Corr.Testing <- glmer(RespCorr ~ Condition + Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Ress.Corr.Testing)

anova(Model.Ress.Corr.Testing)

summary(glht(Model.Ress.Corr.Testing, linfct = mcp(Condition = "Tukey")), test = adjusted("holm"))
```

####Modeling master thesis Correctness pilot data for Training Condition + Block
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)

DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "10"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Ress.Corr.Testing <- glmer(RespCorr ~ Condition + Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= binomial)

summary(Model.Ress.Corr.Testing)

anova(Model.Ress.Corr.Testing)

summary(glht(Model.Ress.Corr.Testing, linfct = mcp(Condition = "Tukey")), test = adjusted("holm"))
```

####Modeling master thesis RT pilot data for Test Condition + Block
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)

DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "10"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Ress.Corr.Testing <- glmer(RT ~ Condition + Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= gaussian)

summary(Model.Ress.Corr.Testing)

anova(Model.Ress.Corr.Testing)

summary(glht(Model.Ress.Corr.Testing, linfct = mcp(Condition = "Tukey")), test = adjusted("holm"))
```

#Modeling master thesis RT pilot data for Training Condition + Block
```{r}
DataNew <- read.csv("D:/WIN/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)

DataSubset <- subset(DataNew, Block == "1")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Ress.Corr.Testing <- glmer(RT ~ Condition +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= inverse.gaussian(link= "identity"))

summary(Model.Ress.Corr.Testing)

anova(Model.Ress.Corr.Testing)

summary(glht(Model.Ress.Corr.Testing, linfct = mcp(Condition = "Tukey")), test = adjusted("holm"))
```