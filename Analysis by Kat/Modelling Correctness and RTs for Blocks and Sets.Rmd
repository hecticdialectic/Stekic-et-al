---
title: "Modelling Blocks and Sets"
author: "Katarina Stekic"
date: "November 9, 2019"
output: html_document
---

####Loading libraries
```{r}
library(data.table)
library(tidyverse)
library(ggthemes)
library(outliers)
library(lme4)
library(lmerTest)
library(afex)
library(kableExtra)
library(agricolae)
library(multcomp)
```

####Modeling Correctness Training data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Block.Training <- glmer(RespCorr ~ Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= binomial)

summary(Model.Block.Training)

anova(Model.Block.Training)

summary(glht(Model.Block.Training, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling Correctness Testing data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Block.Testing <- glmer(RespCorr ~ Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Block.Testing)

anova(Model.Block.Testing)

summary(glht(Model.Block.Testing, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling Correctness for Stimuli Sets / Training
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Set.Training <- glmer(RespCorr ~ Set +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= binomial)

summary(Model.Set.Training)

anova(Model.Set.Training)

summary(glht(Model.Set.Training, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling Corectness for Stimuli Sets / Testing
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Set.Testing <- glmer(RespCorr ~ Set +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= binomial)

summary(Model.Set.Testing)

anova(Model.Set.Testing)

summary(glht(Model.Set.Testing, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling RT Training data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Block.Training <- glmer(RT ~ Block +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= gaussian())

summary(Model.Block.Training)

anova(Model.Block.Training)

summary(glht(Model.Block.Training, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling RT Testing data with Block as fixed factor
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Block.Testing <- glmer(RT ~ Block +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= gaussian())

summary(Model.Block.Testing)

anova(Model.Block.Testing)

summary(glht(Model.Block.Testing, linfct = mcp(Block = "Tukey")), test = adjusted("holm"))
```

####Modeling RTs for Stimuli Sets / Training
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTraining <- subset(DataSubset, TrialType == "Training")

Model.Set.Training <- glmer(RT ~ Set +
                          (1|ParticipantID),
                          data=DataTraining, 
                          family= gaussian)

summary(Model.Set.Training)

anova(Model.Set.Training)

summary(glht(Model.Set.Training, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

####Modeling RTs for Stimuli Sets / Testing
```{r}
DataNew <- read.csv("C:/Users/775/Documents/GitHub/Stekic-et-al/Data/CleanData4.csv")

DataNew$ParticipantID <- as.factor(DataNew$ParticipantID)
DataNew$Condition <- as.factor(DataNew$Condition)
DataNew$Block <- as.factor(DataNew$Block)
DataNew$Set <- as.factor(DataNew$Set)


DataSubset <- subset(DataNew, Condition == "1"|Condition == "2"|Condition == "3A"|Condition == "4"|Condition == "10"| Condition == "5"| 
                       Condition == "6A"|Condition == "7"|Condition == "8"|Condition == "9")

DataTesting <- subset(DataSubset, TrialType == "Testing")

Model.Set.Testing <- glmer(RT ~ Set +
                          (1|ParticipantID),
                          data=DataTesting, 
                          family= gaussian)

summary(Model.Set.Testing)

anova(Model.Set.Testing)

summary(glht(Model.Set.Testing, linfct = mcp(Set = "Tukey")), test = adjusted("holm"))
```

